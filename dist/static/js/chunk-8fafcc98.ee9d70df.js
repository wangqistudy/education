(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8fafcc98"],{1992:function(e,t,a){"use strict";var n=a("63e5"),i=a.n(n);i.a},"1b80":function(e,t,a){"use strict";a("8e6e"),a("ac6a"),a("456d");var n=a("bd86"),i=a("5f87"),o=a("2f62");function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l=a("4328");t["a"]={data:function(){return{totalCount:0,pageSize:10,currPage:1,tableData:[],pageLoading:!0,totalPage:1,dataFilters:{}}},computed:r({},Object(o["c"])(["roles"])),methods:{getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dataFilters;return this.pageLoading=!0,new Promise((function(a,n){t=Object.assign({},t),void 0===t.page&&(t.page=e.currPage),void 0===t.page_num&&(t.page_num=e.pageSize),e.listApi(t).then((function(t){void 0!==t.code&&(e.tableData=t.data.data?t.data.data:[],e.setPagination(t.data.meta.pagination),e.pageLoading=!1),a(t)})).catch((function(t){e.pageLoading=!1,n(t)}))}))},setPagination:function(e){if(e){var t=e.total,a=e.per_page,n=e.current_page,i=e.total_pages;this.totalCount=t-0,this.pageSize=a-0,this.currPage=n-0,this.totalPage=i-0}},handleCurrentChange:function(e){return this.currPage=e,this.getList()},setDataFilters:function(e){this.$set(this,"dataFilters",e)},handleExport:function(e){var t=this,a=Object(i["a"])(),n=Object.assign({},this.dataFilters,{is_export:1}),o={responseType:"blob"};n.token=a,n=l.stringify(n),this.$http.post(e,n,o).then((function(e){var a,n=e.headers;a=n.exportexcelname?decodeURI(n.exportexcelname):"excel.xlsx",t.download(e.data,a)}))},download:function(e,t){if(e){var a=window.URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),n=document.createElement("a");n.style.display="none",n.href=a;var i=t||"excel.xlsx";n.setAttribute("download",i),document.body.appendChild(n),n.click()}},proxy_handleDelete:function(e,t,a){var n=this;this.$confirm("即将".concat(a||"删除该条记录",", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n[t]&&n[t](e)})).catch((function(){}))}}}},"48b9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comment-set-wrap page-wrap"},[a("div",{staticClass:"common-set  page-inner"},[a("p",{staticClass:"set-header page-header"},[e._v("\n            权限分配\n        ")]),e._v(" "),a("div",{staticClass:"page-table"},[a("div",{staticClass:"header-btn"},[e.hasEditPermission?a("el-button",{attrs:{icon:"el-icon-plus",type:"success"},on:{click:function(t){return e.handleEdit(null,"add")}}},[e._v("新增普通教务")]):e._e()],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,"header-row-class-name":"headrow","header-cell-class-name":"headrowcell"}},[a("el-table-column",{attrs:{prop:"id",label:"序号","header-align":"center",align:"center",width:"50px"}}),e._v(" "),a("el-table-column",{attrs:{label:"普通教务账号","header-align":"center",align:"center",prop:"education_admin_login"}}),e._v(" "),a("el-table-column",{attrs:{prop:"education_admin_job_num",label:"工号","header-align":"center",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"二次更改签到状态","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(1==t.row.can_modify_sign?"是":"否"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间","header-align":"center",align:"center"}}),e._v(" "),e.hasEditPermission?a("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleEdit(t.row,"edit")}}},[e._v("\n                      修改\n                    ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"default"},on:{click:function(a){return e.proxy_handleDelete(t.row.id,"handleDelete")}}},[e._v("\n                      删除\n                    ")])]}}],null,!1,1291228062)}):e._e()],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.currPage,"page-size":e.pageSize,layout:"prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currPage=t},"update:current-page":function(t){e.currPage=t}}})],1)],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.showEdit,width:"700px","close-on-click-modal":!1,title:("edit"==e.dialogType?"修改":"新增")+"普通教务"},on:{"update:visible":function(t){e.showEdit=t}}},[a("el-form",{ref:"formData",attrs:{model:e.formData,"label-width":"100px",rules:e.formRule}},[a("div",{staticClass:"inline"},[a("el-form-item",{attrs:{label:"教务账号：",prop:"education_admin_login"}},[a("el-input",{attrs:{disabled:"edit"==e.dialogType},model:{value:e.formData.education_admin_login,callback:function(t){e.$set(e.formData,"education_admin_login",t)},expression:"formData.education_admin_login"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"工号：",prop:"education_admin_job_num"}},[a("el-input",{attrs:{disabled:"edit"==e.dialogType},model:{value:e.formData.education_admin_job_num,callback:function(t){e.$set(e.formData,"education_admin_job_num",t)},expression:"formData.education_admin_job_num"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"选择校区"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{on:{change:e.handleSchoolChange},model:{value:e.SelSchoolList,callback:function(t){e.SelSchoolList=t},expression:"SelSchoolList"}},e._l(e.schoolList,(function(t,n){return a("el-checkbox",{key:n,attrs:{label:t.id}},[e._v("\n                        "+e._s(t.name)+"\n                    ")])})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"课程编号: ",prop:"lesson_ids"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate1},on:{change:e.handleCheckAllChange1},model:{value:e.checkAll1,callback:function(t){e.checkAll1=t},expression:"checkAll1"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCoursnChange},model:{value:e.SelCourseSns,callback:function(t){e.SelCourseSns=t},expression:"SelCourseSns"}},e._l(e.courseSnList,(function(t,n){return a("el-checkbox",{key:n,attrs:{label:t.id}},[e._v("\n                        "+e._s(t.value)+"\n                    ")])})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"是否可以二次更改签到状态:","label-width":"200px",prop:"can_modify_sign"}},[a("div",[a("el-radio-group",{model:{value:e.formData.can_modify_sign,callback:function(t){e.$set(e.formData,"can_modify_sign",t)},expression:"formData.can_modify_sign"}},[a("el-radio",{attrs:{label:0}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1)])],1),e._v(" "),a("div",{staticClass:"subBtn"},[a("el-button",{attrs:{type:"success"},on:{click:e.handleSub}},[e._v("确定")])],1)],1)],1)},i=[],o=(a("456d"),a("ac6a"),a("cc96")),s=a("40cb"),r=a("60c5"),l=a("1b80"),c=a("7c15"),d={name:"authority",components:{editorCom:o["a"],uploadImg:s["a"],filterCom:r["a"]},mixins:[l["a"]],data:function(){var e=function(e,t,a){return 0===t?a():t?void a():a(new Error("请填将信息填写完整"))};return{imgList:[],checkedTeacher:[],listApi:c["b"].privilege_list,dynamicTags:["标签一","标签二","标签三"],dialogType:"edit",formData:{},formRule:{education_admin_login:[{validator:e}],education_admin_job_num:[{validator:e}],courses:[{validator:e}],can_modify_sign:[{validator:e}]},showEdit:!1,apiList:c["a"],schoolList:[],SelSchoolList:[],isIndeterminate:!1,checkAll:!1,SelCourseSns:[],courseSnList:[],isIndeterminate1:!1,checkAll1:!1}},mounted:function(){this.getList(),this.getSchoolList()},watch:{SelSchoolList:{handler:function(){var e=this;if(this.SelSchoolList.length>0){var t=this.SelSchoolList.join(",");c["b"].education_admin_search_course({ids:t}).then((function(t){e.courseSnList=t.data,e.handleCoursnChange(e.SelCourseSns)}))}else this.courseSnList=[],this.SelCourseSns=[]},deep:!0}},methods:{handleCheckAllChange:function(e){this.SelSchoolList=e?this.schoolList.map((function(e){return e.id})):[],this.isIndeterminate=!1},handleCheckAllChange1:function(e){this.SelCourseSns=e?this.courseSnList.map((function(e){return e.id})):[],this.isIndeterminate1=!1},handleSchoolChange:function(e){var t=e.length;this.checkAll=t===this.schoolList.length,this.isIndeterminate=t>0&&t<this.schoolList.length},handleCoursnChange:function(e){var t=e.length;this.checkAll1=t===this.courseSnList.length,this.isIndeterminate1=t>0&&t<this.courseSnList.length},getSchoolList:function(){var e=this;c["b"].school_list({pase_num:1e4,page:1}).then((function(t){e.schoolList=t.data.data}))},handleAddNewSn:function(){var e=this;this.formData.courseSn?(this.formData.courses||this.$set(this.formData,"courses",[]),this.formData.courses.some((function(t){return t.course_sn===e.formData.courseSn}))?this.$appmessage({type:"error",message:"不能重复添加"}):this.formData.courses.push({course_sn:this.formData.courseSn})):this.$appmessage({type:"error",message:"请填写正确的课程编号"})},handleDelete:function(e){var t=this;c["b"].privilege_delete({id:e}).then((function(e){t.showEdit=!1,t.$appmessage({type:"success",message:e.message||"删除成功"}),t.getList()}))},handleSub:function(){var e=this;this.$refs.formData.validate((function(t){if(t){var a=JSON.parse(JSON.stringify(e.formData));a.courses=e.SelCourseSns.join(","),c["b"].privilege_save(a).then((function(t){e.showEdit=!1,e.$appmessage({type:"success",message:t.message||"添加成功"}),e.getList()}))}}))},handlePictureCardPreview:function(e){this.openPreview({src:e.thumbnail})},handleEdit:function(e,t){var a=this;if(this.dialogType=t,"add"==t)return this.formData={},this.SelCourseSns=[],this.courseSnList=[],this.SelSchoolList=[],this.checkAll=!1,this.checkAll1=!1,this.isIndeterminate=!1,this.isIndeterminate1=!1,void(this.showEdit=!0);c["b"].privilege_detail({id:e.id}).then((function(t){t=t.data,Object.keys(t).forEach((function(n){if("courses"==n){for(var i=[],o=0,s=t[n].length;o<s;o++)i.indexOf(t[n][o].school_id)<=-1&&i.push(t[n][o].school_id);a.SelSchoolList=i;var r=JSON.parse(JSON.stringify(i));a.handleSchoolChange(r);for(var l=[],c=0,d=t[n].length;c<d;c++)l.indexOf(t[n][c].course_id)<=-1&&l.push(t[n][c].course_id);a.SelCourseSns=l;var u=JSON.parse(JSON.stringify(l));a.handleCoursnChange(u)}else a.$set(a.formData,n,e[n])})),a.showEdit=!0}))}}},u=d,h=(a("1992"),a("2877")),p=Object(h["a"])(u,n,i,!1,null,"bca1f28a",null);t["default"]=p.exports},"63e5":function(e,t,a){}}]);