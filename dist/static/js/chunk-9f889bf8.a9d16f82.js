(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9f889bf8"],{"0fff":function(e,t,a){"use strict";var i=a("c598"),n=a.n(i);n.a},"1b80":function(e,t,a){"use strict";a("8e6e"),a("ac6a"),a("456d");var i=a("bd86"),n=a("5f87"),r=a("2f62");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var s=a("4328");t["a"]={data:function(){return{totalCount:0,pageSize:10,currPage:1,tableData:[],pageLoading:!0,totalPage:1,dataFilters:{}}},computed:l({},Object(r["c"])(["roles"])),methods:{getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dataFilters;return this.pageLoading=!0,new Promise((function(a,i){t=Object.assign({},t),void 0===t.page&&(t.page=e.currPage),void 0===t.page_num&&(t.page_num=e.pageSize),e.listApi(t).then((function(t){void 0!==t.code&&(e.tableData=t.data.data?t.data.data:[],e.setPagination(t.data.meta.pagination),e.pageLoading=!1),a(t)})).catch((function(t){e.pageLoading=!1,i(t)}))}))},setPagination:function(e){if(e){var t=e.total,a=e.per_page,i=e.current_page,n=e.total_pages;this.totalCount=t-0,this.pageSize=a-0,this.currPage=i-0,this.totalPage=n-0}},handleCurrentChange:function(e){return this.currPage=e,this.getList()},setDataFilters:function(e){this.$set(this,"dataFilters",e)},handleExport:function(e){var t=this,a=Object(n["a"])(),i=Object.assign({},this.dataFilters,{is_export:1}),r={responseType:"blob"};i.token=a,i=s.stringify(i),this.$http.post(e,i,r).then((function(e){var a,i=e.headers;a=i.exportexcelname?decodeURI(i.exportexcelname):"excel.xlsx",t.download(e.data,a)}))},download:function(e,t){if(e){var a=window.URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),i=document.createElement("a");i.style.display="none",i.href=a;var n=t||"excel.xlsx";i.setAttribute("download",n),document.body.appendChild(i),i.click()}},proxy_handleDelete:function(e,t,a){var i=this;this.$confirm("即将".concat(a||"删除该条记录",", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i[t]&&i[t](e)})).catch((function(){}))}}}},c598:function(e,t,a){},ca64:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comment-set-wrap page-wrap"},[a("div",{staticClass:"common-set  page-inner"},[a("p",{staticClass:"set-header page-header"},[e._v("\n            教师设置\n        ")]),e._v(" "),a("div",{staticClass:"page-table"},[a("div",{staticClass:"filter-wrap"},[a("filterCom",{attrs:{filterOptions:e.filterOptions,type:"keyValue"},on:{dosearch:e.handleDoSearch}},[a("template",{slot:"anotherbtn"},[e.hasEditPermission?a("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){return e.handleEdit(null,"add")}}},[e._v("\n                      新增\n                    ")]):e._e()],1)],2)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],attrs:{data:e.tableData,"header-row-class-name":"headrow","header-cell-class-name":"headrowcell"}},[a("el-table-column",{attrs:{prop:"id",label:"序号","header-align":"center",align:"center",width:"50px"}}),e._v(" "),a("el-table-column",{attrs:{label:"图片","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"imgWrap img-item"},[a("img",{attrs:{src:t.row.thumbnail,alt:""}}),e._v(" "),a("p",{staticClass:"img-opt"},[a("span",{on:{click:function(a){return e.handlePictureCardPreview(t.row)}}},[a("i",{staticClass:"el-icon-zoom-in"})])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"姓名","header-align":"center",align:"center",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{prop:"job_code",label:"工号","header-align":"center",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"school",label:"毕业院校","header-align":"center",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"学历","header-align":"center",align:"center",prop:"educationLevelName"}}),e._v(" "),a("el-table-column",{attrs:{prop:"subjectName",label:"科目","header-align":"center",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"教师简介","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(" "+e._s(e._f("chineseWord")(t.row.desc))+" ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否展示为名师","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(1==t.row.is_star?"是":"否"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否展示在首页","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(0==t.row.index_page_no?"否":t.row.index_page_no+"号位"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"weight",label:"排序权重","header-align":"center",align:"center"}}),e._v(" "),e.hasEditPermission?a("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleEdit(t.row,"edit")}}},[e._v("\n                      修改\n                    ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"default"},on:{click:function(a){return e.proxy_handleDelete(t.row.id,"handleDelete")}}},[e._v("\n                      删除\n                    ")])]}}],null,!1,1291228062)}):e._e()],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.currPage,"page-size":e.pageSize,layout:"prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currPage=t},"update:current-page":function(t){e.currPage=t}}})],1)],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.showEdit,width:"837px",top:"20px","close-on-click-modal":!1,title:("edit"==e.dialogType?"修改":"新增")+"信息"},on:{"update:visible":function(t){e.showEdit=t},close:function(t){return e.$refs.formData.resetFields()}}},[a("el-form",{ref:"formData",attrs:{model:e.formData,"label-width":"130px",rules:e.formRule}},[a("el-form-item",{attrs:{label:"图片：",prop:"thumbnail"}},[a("uploadImg",{attrs:{desc:"上传图片推荐尺寸：212x212",actionUrl:"/api"+e.apiList.teacher_upload,files:e.imgList},model:{value:e.imgList,callback:function(t){e.imgList=t},expression:"imgList"}})],1),e._v(" "),a("div",{staticClass:"inline"},[a("el-form-item",{attrs:{label:"是否展示为名师：",prop:"is_star"}},[a("el-radio-group",{model:{value:e.formData.is_star,callback:function(t){e.$set(e.formData,"is_star",t)},expression:"formData.is_star"}},[a("el-radio",{attrs:{label:0}},[e._v("否")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1),e._v(" "),1==e.formData.is_star?a("el-form-item",{attrs:{label:"展示在首页：",prop:"index_page_no"}},[a("el-radio-group",{model:{value:e.formData.index_page_no,callback:function(t){e.$set(e.formData,"index_page_no",t)},expression:"formData.index_page_no"}},[a("el-radio",{attrs:{label:0}},[e._v("否")]),e._v(" "),e._l(e.pageNoSel,(function(t,i){return a("el-radio",{key:i,attrs:{label:t.value,disabled:!t.enable}},[e._v(e._s(t.value)+"号")])}))],2)],1):e._e()],1),e._v(" "),a("div",{staticClass:"inline"},[a("el-form-item",{attrs:{label:"姓名：",prop:"name"}},[a("el-input",{model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"工号：",prop:"job_code"}},[a("el-input",{model:{value:e.formData.job_code,callback:function(t){e.$set(e.formData,"job_code",t)},expression:"formData.job_code"}})],1)],1),e._v(" "),a("div",{staticClass:"inline"},[a("el-form-item",{attrs:{label:"学历：",prop:"education_level"}},[a("el-select",{model:{value:e.formData.education_level,callback:function(t){e.$set(e.formData,"education_level",t)},expression:"formData.education_level"}},e._l(e.educationLevelConfig,(function(e,t){return a("el-option",{key:t,attrs:{value:e.id,label:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"毕业院校：",prop:"school"}},[a("el-input",{model:{value:e.formData.school,callback:function(t){e.$set(e.formData,"school",t)},expression:"formData.school"}})],1)],1),e._v(" "),a("div",{staticClass:"inline"},[a("el-form-item",{attrs:{label:"科目：",prop:"subject_id"}},[a("el-select",{model:{value:e.formData.subject_id,callback:function(t){e.$set(e.formData,"subject_id",t)},expression:"formData.subject_id"}},e._l(e.subjectConfig,(function(e,t){return a("el-option",{key:t,attrs:{value:e.id,label:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"排序权重：",prop:"weight"}},[a("el-input-number",{attrs:{controls:!1},model:{value:e.formData.weight,callback:function(t){e.$set(e.formData,"weight",t)},expression:"formData.weight"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"教师简介：",prop:"desc"}},[a("editorCom",{attrs:{options:e.editOptions},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}}),e._v(" "),a("p",{staticClass:"html5EditTips"},[e._v("(备注:上传图片参考宽度:930px)")])],1)],1),e._v(" "),a("div",{staticClass:"subBtn"},[a("el-button",{attrs:{type:"success"},on:{click:e.handleSub}},[e._v("确定")])],1)],1)],1)},n=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("a481"),a("bd86")),o=a("cc96"),l=a("40cb"),s=a("60c5"),c=a("1b80"),u=a("5f87"),d=a("7c15"),p=a("2f62");function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m={name:"teacherSet",components:{editorCom:o["a"],uploadImg:l["a"],filterCom:s["a"]},mixins:[c["a"]],data:function(){var e=function(e,t,a){if(!t)return a(new Error("请填写信息"));a()},t=function(e,t,a){if(!t)return a(new Error("请填写地址"));a()},a=function(e,t,a){if(!t)return a(new Error("请上传图片"));a()},i=function(e,t,a){if(!t)return a(new Error("请填写信息"));a()};return{editOptions:{uploadJson:"/api"+d["a"].teacher_upload+"?token="+Object(u["a"])()},imgList:[],listApi:d["b"].teacher_list,filterOptions:[{label:"教师姓名:",filed:"name",opt:"$like",options:[],defaultValue:"",type:"select",optionUrl:"",remoteUrl:d["a"].teacher_search},{label:"科目:",filed:"subject",opt:"$eq",options:[],defaultValue:"",type:"select",optionUrl:""}],dialogType:"edit",formData:{is_star:0,weight:1},formRule:{address:[{validator:t}],job_code:[{validator:e}],education_level:[{validator:e}],school:[{validator:e}],desc:[{validator:e}],subject_id:[{validator:e}],name:[{validator:i}],thumbnail:[{validator:a}]},showEdit:!1,apiList:d["a"],educationLevelConfig:[],subjectConfig:[],pageNoSel:[]}},mounted:function(){this.getList(),this.getOptions(),this.getSearchList(this.$route.query.collect_user)},activated:function(){this.getSearchList(this.$route.query.collect_user)},computed:h({},Object(p["e"])({pathFilter:function(e){return e.redirect["/system_set/teacher_set"]}})),filters:{chineseWord:function(e){if(!e)return"";var t=document.createElement("div");t.innerHTML=e;var a=t.innerText;return a.slice(0,20)}},methods:h({},Object(p["d"])({updatePathRedirect:"redirect/updatePathRedirect"}),{getSearchList:function(e){if(e){var t=Object.assign({},this.dataFilters,{user_id:e});this.getList(t),this.$router.replace("/system_set/teacher_set")}if(Object.keys(this.pathFilter).length>0){var a=Object.assign({},this.dataFilters,this.pathFilter);this.updatePathRedirect({path:"/system_set/teacher_set",data:{}}),this.getList(a)}},handleDoSearch:function(e){this.setDataFilters(e),this.getList()},handleDelete:function(e){var t=this;d["b"].teacher_delete({id:e}).then((function(e){t.showEdit=!1,t.getList(),t.$appmessage({type:"success",message:e.message||"删除成功"})}))},getOptions:function(){var e=this;d["b"].teacher_config().then((function(t){var a=t.data,i=a.educationLevelConfig,n=a.subjectConfig,r=a.pageNoMap;e.educationLevelConfig=i,e.subjectConfig=n,e.filterOptions[1].options=n;var o=[];Object.keys(r).forEach((function(t){o.push({value:r[t].index_page_no-0,enable:r[t].teacher_id<=0||e.formData.id==r[t].teacher_id,teacher_id:r[t].teacher_id})})),e.pageNoSel=o}))},handleSub:function(){var e=this,t=this.imgList[0]?this.imgList[0].url:"";this.$set(this.formData,"thumbnail",t),this.$refs.formData.validate((function(a){if(a){var i=JSON.parse(JSON.stringify(e.formData));i.thumbnail=t,d["b"].teacher_save(i).then((function(t){e.showEdit=!1,e.getList(),e.$appmessage({type:"success",message:t.message||"保存成功"})}))}}))},handlePictureCardPreview:function(e){this.openPreview({src:e.thumbnail})},handleEdit:function(e,t){var a=this;if(this.dialogType=t,"add"==t)return this.formData={is_star:0,weight:1,desc:""},this.imgList=[],this.getOptions(),void(this.showEdit=!0);Object.keys(e).forEach((function(t){a.$set(a.formData,t,e[t]),"thumbnail"==t&&(a.imgList=[{url:e[t]}]),"subject_id"==t&&(a.subjectConfig.some((function(t){return t.id==e.subject_id}))||a.$set(a.formData,t,""))})),this.getOptions(),this.showEdit=!0}})},g=m,b=(a("0fff"),a("2877")),v=Object(b["a"])(g,i,n,!1,null,"6ef78e82",null);t["default"]=v.exports}}]);